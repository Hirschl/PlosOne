LIBNAME WEALTH84 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth1984";
LIBNAME WEALTH89 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth1989";
LIBNAME WEALTH94 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth1994";
LIBNAME WEALTH99 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth1999";
LIBNAME WEALTH01 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth2001";
LIBNAME WEALTH03 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth2003";
LIBNAME WEALTH05 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth2005";
LIBNAME WEALTH07 "U:\1Projects\PSID\WAVE37\SOURCEFILES\wlth2007";

%MACRO MYLIB;
%DO J = 1 %TO 37 ;
%LET I = %SCAN(&YEAR,&J) ;

LIBNAME FAM&I "U:\1Projects\PSID\WAVE37\SOURCEFILES\&I\FAM&I";

%END;
%MEND MYLIB;
%MYLIB;


******1984******;

DATA WEALTH84.WLTH1984 (DROP = S101);
SET WEALTH84.WLTH1984 ;
V10002 = S101;
RUN;

PROC SORT DATA = WEALTH84.WLTH1984;
BY V10002;
RUN;

PROC SORT DATA = FAM1984.FAM1984;
BY V10002;
RUN;

DATA FAM1984.FAM1984;
MERGE FAM1984.FAM1984 WEALTH84.WLTH1984;
BY V10002;
RUN;

******1989******;


DATA WEALTH89.WLTH1989 (DROP = S201);
SET WEALTH89.WLTH1989;
V16302 = S201;
RUN;

PROC SORT DATA = WEALTH89.WLTH1989;
BY V16302;
RUN;

PROC SORT DATA = FAM1989.FAM1989;
BY V16302;
RUN;

DATA FAM1989.FAM1989;
MERGE FAM1989.FAM1989 WEALTH89.WLTH1989;
BY V16302;
RUN;


******1994******;

DATA WEALTH94.WLTH1994 (DROP = S301);
SET WEALTH94.WLTH1994 ;
ER2002 = S301;
RUN;

PROC SORT DATA = WEALTH94.WLTH1994;
BY ER2002;
RUN;

PROC SORT DATA = FAM1994.FAM1994;
BY ER2002;
RUN;

DATA FAM1994.FAM1994;
MERGE FAM1994.FAM1994 WEALTH94.WLTH1994;
BY ER2002;
RUN;


******1999******;

DATA WEALTH99.WLTH1999 (DROP = S401);
SET WEALTH99.WLTH1999 ;
ER13002 = S401;
RUN;

PROC SORT DATA = WEALTH99.WLTH1999;
BY ER13002;
RUN;

PROC SORT DATA = FAM1999.FAM1999;
BY ER13002;
RUN;

DATA FAM1999.FAM1999;
MERGE FAM1999.FAM1999 WEALTH99.WLTH1999;
BY ER13002;
RUN;


******2001******;

DATA WEALTH01.WLTH2001 (DROP = S501);
SET WEALTH01.WLTH2001 ;
ER17002 = S501;
RUN;

PROC SORT DATA = WEALTH01.WLTH2001;
BY ER17002;
RUN;

PROC SORT DATA = FAM2001.FAM2001;
BY ER17002;
RUN;

DATA FAM2001.FAM2001;
MERGE FAM2001.FAM2001 WEALTH01.WLTH2001;
BY ER17002;
RUN;


******2003******;

DATA WEALTH03.WLTH2003 (DROP = S601);
SET WEALTH03.WLTH2003 ;
ER21002 = S601;
RUN;

PROC SORT DATA = WEALTH03.WLTH2003;
BY ER21002;
RUN;

PROC SORT DATA = FAM2003.FAM2003;
BY ER21002;
RUN;

DATA FAM2003.FAM2003;
MERGE FAM2003.FAM2003 WEALTH03.WLTH2003;
BY ER21002;
RUN;


******2005******;

DATA WEALTH05.WLTH2005 (DROP = S701);
SET WEALTH05.WLTH2005 ;
ER25002 = S701;
RUN;

PROC SORT DATA = WEALTH05.WLTH2005;
BY ER25002;
RUN;

PROC SORT DATA = FAM2005.FAM2005;
BY ER25002;
RUN;

DATA FAM2005.FAM2005;
MERGE FAM2005.FAM2005 WEALTH05.WLTH2005;
BY ER25002;
RUN;


******2007******;

DATA WEALTH07.WLTH2007 (DROP = S801);
SET WEALTH07.WLTH2007 ;
ER36002 = S801;
RUN;

PROC SORT DATA = WEALTH07.WLTH2007;
BY ER36002;
RUN;

PROC SORT DATA = FAM2007.FAM2007;
BY ER36002;
RUN;

DATA FAM2007.FAM2007;
MERGE FAM2007.FAM2007 WEALTH07.WLTH2007;
BY ER36002;
RUN;


**NO 2009 HERE BECAUSE WEALTH VARIABLES ARE INCLUDED IN THE 2009 FAMILY FILES ALREADY;

