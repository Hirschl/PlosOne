*STEP 11 -CREATE LIFE TABLES;

%LET SY = 45;

LIBNAME PSID "U:\1Projects\PSID\WAVE37\WORKFILES";
LIBNAME PSIDLT&SY "U:\1Projects\PSID\WAVE37\LIFETABLES&SY";

%LET POVAFF = POVERTY05 POVERTY10 POVERTY15 POVERTY125 AFFLUENCE08 AFFLUENCE10 AFFLUENCE12 WELFARE FAMINC30 FAMINC40 
			  FAMINC50 P15WELFY50 UNEMPLOYMENT P15WY50UNE FAMINC100K FAMINC150K FAMINC200K FOODSTAMPS GAIN30 GAIN40 
			  GAIN50 FAMINC250K HOMEOWNER HE25K HE50K HE100K HE200K AFFLUENCE09 AFFLUENCE11 FAMINCGT80P 
			  FAMINCGT90P FAMINCGT95P FAMINCGT99P SAEZ90P SAEZ95P SAEZ99P FAMINCLT1P FAMINCLT5P FAMINCLT10P FAMINCLT20P;

%MACRO PAF;

%DO I = 37 %TO 40;

%LET PA = %SCAN(&POVAFF,&I);

DATA DURATION_&PA
(KEEP = ER30001 ER30002 ENTRYYEAR &PA._1968-&PA._1997 &PA._1999 &PA._2001 &PA._2003 &PA._2005 &PA._2007 &PA._2009 &PA._2011);
RETAIN ER30001 ER30002 ENTRYYEAR &PA._1968-&PA._1997 &PA._1999 &PA._2001 &PA._2003 &PA._2005 &PA._2007 &PA._2009 &PA._2011;
SET PSID.HOUSEHOLDHEADSELECTEDVARSYBPTW;
ENTRYYEAR = HYBRID_INDIVYEAROFBIRTH + &SY;
IF ENTRYYEAR GE 1968 AND ENTRYYEAR LE 2011;
RUN;

PROC TRANSPOSE DATA = DURATION_&PA OUT = DURATION_&PA._A (RENAME = (COL1 = &PA.STATUS));
BY ER30001 ER30002 ENTRYYEAR;
RUN;

DATA DURATION_&PA._A;
SET  DURATION_&PA._A;
%IF &I<4 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,11,4) * 1;
%END;
%IF &I = 4 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 5 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 6 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 7 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 8 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,9,4) * 1;
%END;
%IF &I = 9 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,10,4) * 1;
%END;
%IF &I = 10 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,10,4) * 1;
%END;
%IF &I = 11 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,10,4) * 1;
%END;
%IF &I = 12 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 13 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,14,4) * 1;
%END;
%IF &I = 14 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 15 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 16 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 17 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 18 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 19 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,8,4) * 1;
%END;
%IF &I = 20 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,8,4) * 1;
%END;
%IF &I = 21 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,8,4) * 1;
%END;
%IF &I = 22 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 23 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,11,4) * 1;
%END;
%IF &I = 24 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,7,4) * 1;
%END;
%IF &I = 25 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,7,4) * 1;
%END;
%IF &I = 26 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,8,4) * 1;
%END;
%IF &I = 27 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,8,4) * 1;
%END;
%IF &I = 28 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 29 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 30 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 31 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 32 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 33 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 34 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,9,4) * 1;
%END;
%IF &I = 35 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,9,4) * 1;
%END;
%IF &I = 36 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,9,4) * 1;
%END;
%IF &I = 37 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 38 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,12,4) * 1;
%END;
%IF &I = 39 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
%IF &I = 40 %THEN %DO;
SURVEYYEAR = SUBSTR(_NAME_,13,4) * 1;
%END;
BY ER30001 ER30002 ENTRYYEAR;
IF ENTRYYEAR LE SURVEYYEAR;
RUN;

PROC TRANSPOSE DATA = DURATION_&PA._A OUT = DURATION_&PA._B PREFIX = &PA._;
BY ER30001 ER30002 ENTRYYEAR;
ID SURVEYYEAR;
RUN;

DATA PSIDLT&SY..DURATION_&PA._&SY (DROP = _NAME_ I &PA._1968-&PA._1997 &PA._1999 &PA._2001 &PA._2003 &PA._2005 &PA._2007 &PA._2009 &PA._2011);
SET DURATION_&PA._B;

ARRAY PAF (37) &PA._1968-&PA._1997 &PA._1999 &PA._2001 &PA._2003 &PA._2005 &PA._2007 &PA._2009 &PA._2011;
ARRAY PAFF (37) &PA.1968-&PA.1997 &PA.1999 &PA.2001 &PA.2003 &PA.2005 &PA.2007 &PA.2009  &PA.2011;
ARRAY YR (31:37) _TEMPORARY_ (1999 2001 2003 2005 2007 2009 2011);

*create a copy of paf vars. the copy (paff) will be the one that will be processed/used in calucating duration/status;
DO I= 1 to 37;
   PAFF(I) = PAF(I);
END;


*determine the start of the wave;

YEARENTERED = ENTRYYEAR;

	 IF YEARENTERED = 1998 THEN YEARENTERED = 1999;
ELSE IF YEARENTERED = 2000 THEN YEARENTERED = 2001;
ELSE IF YEARENTERED = 2002 THEN YEARENTERED = 2003;
ELSE IF YEARENTERED = 2004 THEN YEARENTERED = 2005;
ELSE IF YEARENTERED = 2006 THEN YEARENTERED = 2007;
ELSE IF YEARENTERED = 2008 THEN YEARENTERED = 2009;
ELSE IF YEARENTERED = 2010 THEN YEARENTERED = 2011;

ARRAY EY (37) _TEMPORARY_ (1968 1969 1970 1971 1972 1973 1974 1975 1976 1977 1978 1979 1980
											1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 
											1991 1992 1993 1994 1995 1996 1997 1999 2001 2003 2005 2007 2009 2011);

*determine the start of the wave;


DO I = 1 TO 37;
	IF EY(I) = YEARENTERED THEN WAVESTART = I;
END;


*determine the end of the wave;

DO I= WAVESTART TO 37;
   IF I < 37 AND PAF(I) EQ . AND PAF(I+1) EQ . THEN
	 DO;
		WAVEEND = I-1; 
	    GOTO EXITWE;
	 END;
   ELSE IF I = 37 AND &PA._2009 NE . AND &PA._2011 EQ . THEN 
	 DO; 
		WAVEEND = 36;
	    GOTO EXITWE;
	 END;
   ELSE IF I = 37 AND &PA._2009 NE . AND &PA._2011 NE . THEN 
	 DO; 
		WAVEEND = 37;
	    GOTO EXITWE;
	 END;
   ELSE IF I = 37 AND &PA._2009 EQ . AND &PA._2011 NE . THEN 
	 DO; 
		WAVEEND = 37;
	    GOTO EXITWE;
	 END;
END;
EXITWE:

IF WAVEEND = . AND WAVEEND LT WAVESTART THEN DELETE;

*declare everything from waveend+1 to 37 as missing;
DO I= WAVEEND+1 TO 37;
   PAFF(I) = .;
END;

*count the number of missing years of data;
NUMMISSING = 0;
DO I= 1 TO 37;
   IF PAFF(I) = . THEN NUMMISSING = NUMMISSING + 1;
END;
IF NUMMISSING = 37 THEN DELETE; *i.e., no data (everything missing) across all waves;

DROP NUMMISSING; *remove the variable nummissing;

*calculates duration until first pa was experienced AND also calculates status whether pa was experienced (1) or not (0);

&PA.STATUS = 0;
DO I= WAVESTART TO WAVEEND;
   IF PAFF(I) EQ 1 THEN
	 DO;
		&PA.LASTWAVE = I; 
		&PA.STATUS = 1;
	    GOTO EXIT&PA;
	 END;
END;
EXIT&PA:

IF &PA.STATUS = 1 THEN 
DO;
	IF WAVESTART LE 30 AND &PA.LASTWAVE GE 31 THEN &PA.DURATION1STEXPER = (30-WAVESTART+1)+((&PA.LASTWAVE-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE LE 30 THEN &PA.DURATION1STEXPER = (&PA.LASTWAVE-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION1STEXPER = ((&PA.LASTWAVE-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION1STEXPER = ((&PA.LASTWAVE-WAVESTART)*2)+1+1;
END;
ELSE IF &PA.STATUS = 0 THEN 
DO;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION1STEXPER = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION1STEXPER = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION1STEXPER = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION1STEXPER = ((WAVEEND-WAVESTART)*2)+1+1;
END;

&PA.WAVE1STEXPER=&PA.LASTWAVE;

DROP &PA.LASTWAVE;

%PUT &PA.STATUS = 0;


/*****************************************************************************/
/****DURATION & STATUS OF TWO (2)  CONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.CONS2YEARS = 0;
&PA.STATUS2YRSCONS = 0;
&PA.DURATION2YRSCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.CONS2YEARS = &PA.CONS2YEARS + 1;
			&PA.LASTWAVE2YRSCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.CONS2YEARS = &PA.CONS2YEARS;
	ELSE IF PAFF(I) = 0 THEN &PA.CONS2YEARS = 0;
	IF  &PA.CONS2YEARS = 2 THEN GOTO EXITCONS2;
END;
EXITCONS2:

IF &PA.CONS2YEARS = 2 THEN 
DO;
	&PA.STATUS2YRSCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE2YRSCONS GE 31 THEN &PA.DURATION2YRSCONS = (30-WAVESTART+1)+((&PA.LASTWAVE2YRSCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE2YRSCONS LE 30 THEN &PA.DURATION2YRSCONS = (&PA.LASTWAVE2YRSCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE2YRSCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSCONS = ((&PA.LASTWAVE2YRSCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE2YRSCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSCONS = ((&PA.LASTWAVE2YRSCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.STATUS2YRSCONS = 0 THEN 
DO;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION2YRSCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION2YRSCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.CONS2YEARS &PA.LASTWAVE2YRSCONS;

/*****************************************************************************/
/****DURATION & STATUS OF THREE (3) CONSECUTIVE YEARS OF POVERTY STATUS***/
/*****************************************************************************/

&PA.CONS3YEARS = 0;
&PA.STATUS3YRSCONS = 0;
&PA.DURATION3YRSCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.CONS3YEARS = &PA.CONS3YEARS + 1;
			&PA.LASTWAVE3YRSCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.CONS3YEARS = &PA.CONS3YEARS;
	ELSE IF PAFF(I) = 0 THEN &PA.CONS3YEARS = 0;
	IF  &PA.CONS3YEARS = 3 THEN GOTO EXITCONS3;
END;
EXITCONS3:

IF &PA.CONS3YEARS = 3 THEN 
DO;
	&PA.STATUS3YRSCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE3YRSCONS GE 31 THEN &PA.DURATION3YRSCONS = (30-WAVESTART+1)+((&PA.LASTWAVE3YRSCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE3YRSCONS LE 30 THEN &PA.DURATION3YRSCONS = (&PA.LASTWAVE3YRSCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE3YRSCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSCONS = ((&PA.LASTWAVE3YRSCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE3YRSCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSCONS = ((&PA.LASTWAVE3YRSCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.STATUS3YRSCONS = 0 THEN 
DO;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION3YRSCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION3YRSCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.CONS3YEARS &PA.LASTWAVE3YRSCONS;

/*****************************************************************************/
/****DURATION & STATUS OF FOUR (4) CONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.CONS4YEARS = 0;
&PA.STATUS4YRSCONS = 0;
&PA.DURATION4YRSCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.CONS4YEARS = &PA.CONS4YEARS + 1;
			&PA.LASTWAVE4YRSCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.CONS4YEARS = &PA.CONS4YEARS;
	ELSE IF PAFF(I) = 0 THEN &PA.CONS4YEARS = 0;
	IF  &PA.CONS4YEARS = 4 THEN GOTO EXITCONS4;
END;
EXITCONS4:

IF &PA.CONS4YEARS = 4 THEN 
DO;
	&PA.STATUS4YRSCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE4YRSCONS GE 31 THEN &PA.DURATION4YRSCONS = (30-WAVESTART+1)+((&PA.LASTWAVE4YRSCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE4YRSCONS LE 30 THEN &PA.DURATION4YRSCONS = (&PA.LASTWAVE4YRSCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE4YRSCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSCONS = ((&PA.LASTWAVE4YRSCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE4YRSCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSCONS = ((&PA.LASTWAVE4YRSCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.STATUS4YRSCONS = 0 THEN 
DO;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION4YRSCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION4YRSCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.CONS4YEARS &PA.LASTWAVE4YRSCONS;

/*****************************************************************************/
/****DURATION & STATUS OF FIVE (5) CONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/


&PA.CONS5YEARS = 0;
&PA.STATUS5YRSCONS = 0;
&PA.DURATION5YRSCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.CONS5YEARS = &PA.CONS5YEARS + 1;
			&PA.LASTWAVE5YRSCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.CONS5YEARS = &PA.CONS5YEARS;
	ELSE IF PAFF(I) = 0 THEN &PA.CONS5YEARS = 0;
	IF  &PA.CONS5YEARS = 5 THEN GOTO EXITCONS5;
END;
EXITCONS5:

IF &PA.CONS5YEARS = 5 THEN 
DO;
	&PA.STATUS5YRSCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE5YRSCONS GE 31 THEN &PA.DURATION5YRSCONS = (30-WAVESTART+1)+((&PA.LASTWAVE5YRSCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE5YRSCONS LE 30 THEN &PA.DURATION5YRSCONS = (&PA.LASTWAVE5YRSCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE5YRSCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSCONS = ((&PA.LASTWAVE5YRSCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE5YRSCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSCONS = ((&PA.LASTWAVE5YRSCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.STATUS5YRSCONS = 0 THEN 
DO;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION5YRSCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION5YRSCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.CONS5YEARS &PA.LASTWAVE5YRSCONS;

/**************************************************************/
/*******TEN (10) CONSECUTIVE YEARS OF POVERTY STATUS*******/
/**************************************************************/

&PA.CONS10YEARS = 0;
&PA.STATUS10YRSCONS = 0;
&PA.DURATION10YRSCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.CONS10YEARS = &PA.CONS10YEARS + 1;
			&PA.LASTWAVE10YRSCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.CONS10YEARS = &PA.CONS10YEARS;
	ELSE IF PAFF(I) = 0 THEN &PA.CONS10YEARS = 0;
	IF  &PA.CONS10YEARS = 10 THEN GOTO EXITCONS10;
END;
EXITCONS10:

IF &PA.CONS10YEARS = 10 THEN 
DO;
	&PA.STATUS10YRSCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE10YRSCONS GE 31 THEN &PA.DURATION10YRSCONS = (30-WAVESTART+1)+((&PA.LASTWAVE10YRSCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE10YRSCONS LE 30 THEN &PA.DURATION10YRSCONS = (&PA.LASTWAVE10YRSCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE10YRSCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSCONS = ((&PA.LASTWAVE10YRSCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE10YRSCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSCONS = ((&PA.LASTWAVE10YRSCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.STATUS10YRSCONS = 0 THEN 
DO;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION10YRSCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION10YRSCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2003, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.CONS10YEARS &PA.LASTWAVE10YRSCONS;


/*****************************************************************************/
/****DURATION & STATUS OF TWO (2)  NONCONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.NONCONS2YEARS = 0;
&PA.STATUS2YRSNONCONS = 0;
&PA.DURATION2YRSNONCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.NONCONS2YEARS = &PA.NONCONS2YEARS + 1;
			&PA.LASTWAVE2YRSNONCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.NONCONS2YEARS = &PA.NONCONS2YEARS;
	IF  &PA.NONCONS2YEARS = 2 THEN GOTO EXITNONCONS2;
END;
EXITNONCONS2:

IF &PA.NONCONS2YEARS = 2 THEN 
DO;
	&PA.STATUS2YRSNONCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE2YRSNONCONS GE 31 THEN &PA.DURATION2YRSNONCONS = (30-WAVESTART+1)+((&PA.LASTWAVE2YRSNONCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE2YRSNONCONS LE 30 THEN &PA.DURATION2YRSNONCONS = (&PA.LASTWAVE2YRSNONCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE2YRSNONCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSNONCONS = ((&PA.LASTWAVE2YRSNONCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE2YRSNONCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSNONCONS = ((&PA.LASTWAVE2YRSNONCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.NONCONS2YEARS < 2 THEN 
DO;
	&PA.STATUS2YRSNONCONS = 0;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION2YRSNONCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION2YRSNONCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION2YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.NONCONS2YEARS &PA.LASTWAVE2YRSNONCONS;

/*****************************************************************************/
/****DURATION & STATUS OF THREE(3)  NONCONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.NONCONS3YEARS = 0;
&PA.STATUS3YRSNONCONS = 0;
&PA.DURATION3YRSNONCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.NONCONS3YEARS = &PA.NONCONS3YEARS + 1;
			&PA.LASTWAVE3YRSNONCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.NONCONS3YEARS = &PA.NONCONS3YEARS;
	IF  &PA.NONCONS3YEARS = 3 THEN GOTO EXITNONCONS3;
END;
EXITNONCONS3:

IF &PA.NONCONS3YEARS = 3 THEN 
DO;
	&PA.STATUS3YRSNONCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE3YRSNONCONS GE 31 THEN &PA.DURATION3YRSNONCONS = (30-WAVESTART+1)+((&PA.LASTWAVE3YRSNONCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE3YRSNONCONS LE 30 THEN &PA.DURATION3YRSNONCONS = (&PA.LASTWAVE3YRSNONCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE3YRSNONCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSNONCONS = ((&PA.LASTWAVE3YRSNONCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE3YRSNONCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSNONCONS = ((&PA.LASTWAVE3YRSNONCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.NONCONS3YEARS < 3 THEN 
DO;
	&PA.STATUS3YRSNONCONS = 0;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION3YRSNONCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION3YRSNONCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION3YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.NONCONS3YEARS &PA.LASTWAVE3YRSNONCONS;


/*****************************************************************************/
/****DURATION & STATUS OF FOUR (4)  NONCONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.NONCONS4YEARS = 0;
&PA.STATUS4YRSNONCONS = 0;
&PA.DURATION4YRSNONCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.NONCONS4YEARS = &PA.NONCONS4YEARS + 1;
			&PA.LASTWAVE4YRSNONCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.NONCONS4YEARS = &PA.NONCONS4YEARS;
	IF  &PA.NONCONS4YEARS = 4 THEN GOTO EXITNONCONS4;
END;
EXITNONCONS4:

IF &PA.NONCONS4YEARS = 4 THEN 
DO;
	&PA.STATUS4YRSNONCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE4YRSNONCONS GE 31 THEN &PA.DURATION4YRSNONCONS = (30-WAVESTART+1)+((&PA.LASTWAVE4YRSNONCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE4YRSNONCONS LE 30 THEN &PA.DURATION4YRSNONCONS = (&PA.LASTWAVE4YRSNONCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE4YRSNONCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSNONCONS = ((&PA.LASTWAVE4YRSNONCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE4YRSNONCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSNONCONS = ((&PA.LASTWAVE4YRSNONCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.NONCONS4YEARS < 4 THEN 
DO;
	&PA.STATUS4YRSNONCONS = 0;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION4YRSNONCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION4YRSNONCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION4YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.NONCONS4YEARS &PA.LASTWAVE4YRSNONCONS;

/*****************************************************************************/
/****DURATION & STATUS OF FIVE (5)  NONCONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.NONCONS5YEARS = 0;
&PA.STATUS5YRSNONCONS = 0;
&PA.DURATION5YRSNONCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.NONCONS5YEARS = &PA.NONCONS5YEARS + 1;
			&PA.LASTWAVE5YRSNONCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.NONCONS5YEARS = &PA.NONCONS5YEARS;
	IF  &PA.NONCONS5YEARS = 5 THEN GOTO EXITNONCONS5;
END;
EXITNONCONS5:

IF &PA.NONCONS5YEARS = 5 THEN 
DO;
	&PA.STATUS5YRSNONCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE5YRSNONCONS GE 31 THEN &PA.DURATION5YRSNONCONS = (30-WAVESTART+1)+((&PA.LASTWAVE5YRSNONCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE5YRSNONCONS LE 30 THEN &PA.DURATION5YRSNONCONS = (&PA.LASTWAVE5YRSNONCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE5YRSNONCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSNONCONS = ((&PA.LASTWAVE5YRSNONCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE5YRSNONCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSNONCONS = ((&PA.LASTWAVE5YRSNONCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.NONCONS5YEARS < 5 THEN 
DO;
	&PA.STATUS5YRSNONCONS = 0;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION5YRSNONCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION5YRSNONCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION5YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.NONCONS5YEARS &PA.LASTWAVE5YRSNONCONS;

/*****************************************************************************/
/****DURATION & STATUS OF TEN (10)  NONCONSECUTIVE YEARS OF POVERTY STATUS****/
/*****************************************************************************/

&PA.NONCONS10YEARS = 0;
&PA.STATUS10YRSNONCONS = 0;
&PA.DURATION10YRSNONCONS = .;

DO I = WAVESTART TO WAVEEND;
	IF PAFF(I) = 1 THEN
		DO;
			&PA.NONCONS10YEARS = &PA.NONCONS10YEARS + 1;
			&PA.LASTWAVE10YRSNONCONS = I;
		END;
	ELSE IF PAFF(I) = . THEN &PA.NONCONS10YEARS = &PA.NONCONS10YEARS;
	IF  &PA.NONCONS10YEARS = 10 THEN GOTO EXITNONCONS10;
END;
EXITNONCONS10:

IF &PA.NONCONS10YEARS = 10 THEN 
DO;
	&PA.STATUS10YRSNONCONS = 1;
	IF WAVESTART LE 30 AND &PA.LASTWAVE10YRSNONCONS GE 31 THEN &PA.DURATION10YRSNONCONS = (30-WAVESTART+1)+((&PA.LASTWAVE10YRSNONCONS-31+1)*2);
	ELSE IF WAVESTART LE 30 AND &PA.LASTWAVE10YRSNONCONS LE 30 THEN &PA.DURATION10YRSNONCONS = (&PA.LASTWAVE10YRSNONCONS-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE10YRSNONCONS GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSNONCONS = ((&PA.LASTWAVE10YRSNONCONS-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND &PA.LASTWAVE10YRSNONCONS GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSNONCONS = ((&PA.LASTWAVE10YRSNONCONS-WAVESTART)*2)+1+1;

END;
ELSE IF &PA.NONCONS10YEARS < 10 THEN 
DO;
	&PA.STATUS10YRSNONCONS = 0;
	IF WAVESTART LE 30 AND WAVEEND GE 31 THEN &PA.DURATION10YRSNONCONS = (30-WAVESTART+1)+((WAVEEND-31+1)*2);
	ELSE IF WAVESTART LE 30 AND WAVEEND LE 30 THEN &PA.DURATION10YRSNONCONS = (WAVEEND-WAVESTART+1);
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR NOT IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1;
	ELSE IF WAVESTART GE 31 AND WAVEEND GE 31 AND ENTRYYEAR IN (1998, 2000, 2002, 2004, 2006, 2008, 2010) THEN &PA.DURATION10YRSNONCONS = ((WAVEEND-WAVESTART)*2)+1+1;
END;

DROP &PA.NONCONS10YEARS &PA.LASTWAVE10YRSNONCONS;

RUN;

PROC SORT DATA = PSIDLT&SY..DURATION_&PA._&SY ;
BY ER30001 ER30002;
RUN;

DATA PSIDLT&SY..DURATION_&PA._&SY;
SET PSIDLT&SY..DURATION_&PA._&SY;
/*REMOVE LATINOS*/
IF ER30001 < 7000;
RUN;

DATA PSIDLT&SY..COV_DUR_&PA._&SY._%sysfunc(today(), mmddyy6.);
MERGE PSIDLT&SY..COVARIATESAT&SY PSIDLT&SY..DURATION_&PA._&SY (IN=A);
BY ER30001 ER30002 ;
IF A=1;
*REMOVE LATINOS;
IF ER30001 < 7000;
RUN;

PROC EXPORT DATA= PSIDLT&SY..COV_DUR_&PA._&SY._%sysfunc(today(), mmddyy6.) 
            OUTFILE= "U:\1Projects\PSID\WAVE37\LIFETABLES&SY\COV_DUR_&PA._&SY._%sysfunc(today(), mmddyy6.).sav" 
            DBMS=SPSS REPLACE;
RUN;

%END;
%MEND PAF;
%PAF; 

/* uncomment this if you want to pool all thematic lifetable variables in one dataset

DATA PSIDLT&SY..DURATIONDATA 
(KEEP =
ER30001 ER30002 ENTRYYEAR
POVERTY05DURATION1STEXPER 		POVERTY05STATUS		POVERTY05STATUS2YRSCONS 	POVERTY05DURATION2YRSCONS	 POVERTY05STATUS3YRSCONS 	POVERTY05DURATION3YRSCONS	 POVERTY05STATUS4YRSCONS 	POVERTY05DURATION4YRSCONS	 POVERTY05STATUS5YRSCONS 	POVERTY05DURATION5YRSCONS	 POVERTY05STATUS10YRSCONS	POVERTY05DURATION10YRSCONS		POVERTY05STATUS2YRSNONCONS 		POVERTY05DURATION2YRSNONCONS 	POVERTY05STATUS3YRSNONCONS 		POVERTY05DURATION3YRSNONCONS 	POVERTY05STATUS4YRSNONCONS 		POVERTY05DURATION4YRSNONCONS 	POVERTY05STATUS5YRSNONCONS 		POVERTY05DURATION5YRSNONCONS POVERTY05STATUS10YRSNONCONS 		POVERTY05DURATION10YRSNONCONS 		
POVERTY10DURATION1STEXPER 		POVERTY10STATUS 	POVERTY10STATUS2YRSCONS 	POVERTY10DURATION2YRSCONS	 POVERTY10STATUS3YRSCONS 	POVERTY10DURATION3YRSCONS	 POVERTY10STATUS4YRSCONS 	POVERTY10DURATION4YRSCONS	 POVERTY10STATUS5YRSCONS 	POVERTY10DURATION5YRSCONS	 POVERTY10STATUS10YRSCONS	POVERTY10DURATION10YRSCONS		POVERTY10STATUS2YRSNONCONS 		POVERTY10DURATION2YRSNONCONS 	POVERTY10STATUS3YRSNONCONS 		POVERTY10DURATION3YRSNONCONS 	POVERTY10STATUS4YRSNONCONS 		POVERTY10DURATION4YRSNONCONS 	POVERTY10STATUS5YRSNONCONS 		POVERTY10DURATION5YRSNONCONS  POVERTY10STATUS10YRSNONCONS 		POVERTY10DURATION10YRSNONCONS 		
POVERTY125DURATION1STEXPER 		POVERTY125STATUS 	POVERTY125STATUS2YRSCONS 	POVERTY125DURATION2YRSCONS	 POVERTY125STATUS3YRSCONS 	POVERTY125DURATION3YRSCONS	 POVERTY125STATUS4YRSCONS 	POVERTY125DURATION4YRSCONS	 POVERTY125STATUS5YRSCONS 	POVERTY125DURATION5YRSCONS	 POVERTY125STATUS10YRSCONS	POVERTY125DURATION10YRSCONS		POVERTY125STATUS2YRSNONCONS 	POVERTY125DURATION2YRSNONCONS 	POVERTY125STATUS3YRSNONCONS 	POVERTY125DURATION3YRSNONCONS 	POVERTY125STATUS4YRSNONCONS 	POVERTY125DURATION4YRSNONCONS 	POVERTY125STATUS5YRSNONCONS 	POVERTY125DURATION5YRSNONCONS POVERTY125STATUS10YRSNONCONS 	POVERTY125DURATION10YRSNONCONS  
POVERTY15WAVE1STEXPER 			POVERTY15DURATION1STEXPER 		POVERTY15STATUS 	POVERTY15STATUS2YRSCONS 	POVERTY15DURATION2YRSCONS	 POVERTY15STATUS3YRSCONS 	POVERTY15DURATION3YRSCONS	 POVERTY15STATUS4YRSCONS 	POVERTY15DURATION4YRSCONS	 POVERTY15STATUS5YRSCONS 	POVERTY15DURATION5YRSCONS	 POVERTY15STATUS10YRSCONS	POVERTY15DURATION10YRSCONS		POVERTY15STATUS2YRSNONCONS 		POVERTY15DURATION2YRSNONCONS 	POVERTY15STATUS3YRSNONCONS 		POVERTY15DURATION3YRSNONCONS 	POVERTY15STATUS4YRSNONCONS 		POVERTY15DURATION4YRSNONCONS 	POVERTY15STATUS5YRSNONCONS 		POVERTY15DURATION5YRSNONCONS POVERTY15STATUS10YRSNONCONS 		POVERTY15DURATION10YRSNONCONS 		
AFFLUENCE08WAVE1STEXPER 		AFFLUENCE08DURATION1STEXPER 	AFFLUENCE08STATUS 	AFFLUENCE08STATUS2YRSCONS 	AFFLUENCE08DURATION2YRSCONS  AFFLUENCE08STATUS3YRSCONS 	AFFLUENCE08DURATION3YRSCONS  AFFLUENCE08STATUS4YRSCONS 	AFFLUENCE08DURATION4YRSCONS  AFFLUENCE08STATUS5YRSCONS 	AFFLUENCE08DURATION5YRSCONS  AFFLUENCE08STATUS10YRSCONS	AFFLUENCE08DURATION10YRSCONS	AFFLUENCE08STATUS2YRSNONCONS	AFFLUENCE08DURATION2YRSNONCONS 	AFFLUENCE08STATUS3YRSNONCONS	AFFLUENCE08DURATION3YRSNONCONS	AFFLUENCE08STATUS4YRSNONCONS	AFFLUENCE08DURATION4YRSNONCONS	AFFLUENCE08STATUS5YRSNONCONS	AFFLUENCE08DURATION5YRSNONCONS AFFLUENCE08STATUS10YRSNONCONS	AFFLUENCE08DURATION10YRSNONCONS
AFFLUENCE09WAVE1STEXPER 		AFFLUENCE09DURATION1STEXPER 	AFFLUENCE09STATUS 	AFFLUENCE09STATUS2YRSCONS 	AFFLUENCE09DURATION2YRSCONS  AFFLUENCE09STATUS3YRSCONS 	AFFLUENCE09DURATION3YRSCONS  AFFLUENCE09STATUS4YRSCONS 	AFFLUENCE09DURATION4YRSCONS  AFFLUENCE09STATUS5YRSCONS 	AFFLUENCE09DURATION5YRSCONS  AFFLUENCE09STATUS10YRSCONS	AFFLUENCE09DURATION10YRSCONS	AFFLUENCE09STATUS2YRSNONCONS	AFFLUENCE09DURATION2YRSNONCONS 	AFFLUENCE09STATUS3YRSNONCONS	AFFLUENCE09DURATION3YRSNONCONS	AFFLUENCE09STATUS4YRSNONCONS	AFFLUENCE09DURATION4YRSNONCONS	AFFLUENCE09STATUS5YRSNONCONS	AFFLUENCE09DURATION5YRSNONCONS AFFLUENCE09STATUS10YRSNONCONS	AFFLUENCE09DURATION10YRSNONCONS
AFFLUENCE10WAVE1STEXPER 		AFFLUENCE10DURATION1STEXPER 	AFFLUENCE10STATUS 	AFFLUENCE10STATUS2YRSCONS 	AFFLUENCE10DURATION2YRSCONS  AFFLUENCE10STATUS3YRSCONS 	AFFLUENCE10DURATION3YRSCONS  AFFLUENCE10STATUS4YRSCONS 	AFFLUENCE10DURATION4YRSCONS  AFFLUENCE10STATUS5YRSCONS 	AFFLUENCE10DURATION5YRSCONS  AFFLUENCE10STATUS10YRSCONS	AFFLUENCE10DURATION10YRSCONS	AFFLUENCE10STATUS2YRSNONCONS	AFFLUENCE10DURATION2YRSNONCONS 	AFFLUENCE10STATUS3YRSNONCONS	AFFLUENCE10DURATION3YRSNONCONS	AFFLUENCE10STATUS4YRSNONCONS	AFFLUENCE10DURATION4YRSNONCONS	AFFLUENCE10STATUS5YRSNONCONS	AFFLUENCE10DURATION5YRSNONCONS AFFLUENCE10STATUS10YRSNONCONS	AFFLUENCE10DURATION10YRSNONCONS
AFFLUENCE11WAVE1STEXPER 		AFFLUENCE11DURATION1STEXPER 	AFFLUENCE11STATUS 	AFFLUENCE11STATUS2YRSCONS 	AFFLUENCE11DURATION2YRSCONS  AFFLUENCE11STATUS3YRSCONS 	AFFLUENCE11DURATION3YRSCONS  AFFLUENCE11STATUS4YRSCONS 	AFFLUENCE11DURATION4YRSCONS  AFFLUENCE11STATUS5YRSCONS 	AFFLUENCE11DURATION5YRSCONS  AFFLUENCE11STATUS10YRSCONS	AFFLUENCE11DURATION10YRSCONS	AFFLUENCE11STATUS2YRSNONCONS	AFFLUENCE11DURATION2YRSNONCONS 	AFFLUENCE11STATUS3YRSNONCONS	AFFLUENCE11DURATION3YRSNONCONS	AFFLUENCE11STATUS4YRSNONCONS	AFFLUENCE11DURATION4YRSNONCONS	AFFLUENCE11STATUS5YRSNONCONS	AFFLUENCE11DURATION5YRSNONCONS AFFLUENCE11STATUS10YRSNONCONS	AFFLUENCE11DURATION10YRSNONCONS
AFFLUENCE12WAVE1STEXPER 		AFFLUENCE12DURATION1STEXPER		AFFLUENCE12STATUS	AFFLUENCE12STATUS2YRSCONS 	AFFLUENCE12DURATION2YRSCONS  AFFLUENCE12STATUS3YRSCONS 	AFFLUENCE12DURATION3YRSCONS  AFFLUENCE12STATUS4YRSCONS 	AFFLUENCE12DURATION4YRSCONS  AFFLUENCE12STATUS5YRSCONS 	AFFLUENCE12DURATION5YRSCONS  AFFLUENCE12STATUS10YRSCONS	AFFLUENCE12DURATION10YRSCONS	AFFLUENCE12STATUS2YRSNONCONS	AFFLUENCE12DURATION2YRSNONCONS 	AFFLUENCE12STATUS3YRSNONCONS	AFFLUENCE12DURATION3YRSNONCONS	AFFLUENCE12STATUS4YRSNONCONS	AFFLUENCE12DURATION4YRSNONCONS	AFFLUENCE12STATUS5YRSNONCONS	AFFLUENCE12DURATION5YRSNONCONS AFFLUENCE12STATUS10YRSNONCONS	AFFLUENCE12DURATION10YRSNONCONS
WELFAREDURATION1STEXPER	    	WELFARESTATUS	WELFARESTATUS2YRSCONS 	WELFAREDURATION2YRSCONS  WELFARESTATUS3YRSCONS 	WELFAREDURATION3YRSCONS  WELFARESTATUS4YRSCONS 	WELFAREDURATION4YRSCONS  WELFARESTATUS5YRSCONS 	WELFAREDURATION5YRSCONS  WELFARESTATUS10YRSCONS	WELFAREDURATION10YRSCONS	WELFARESTATUS2YRSNONCONS	WELFAREDURATION2YRSNONCONS 	WELFARESTATUS3YRSNONCONS	WELFAREDURATION3YRSNONCONS	WELFARESTATUS4YRSNONCONS	WELFAREDURATION4YRSNONCONS	WELFARESTATUS5YRSNONCONS	WELFAREDURATION5YRSNONCONS WELFARESTATUS10YRSNONCONS	WELFAREDURATION10YRSNONCONS
FAMINC30DURATION1STEXPER		FAMINC30STATUS	FAMINC30STATUS2YRSCONS 	FAMINC30DURATION2YRSCONS  FAMINC30STATUS3YRSCONS 	FAMINC30DURATION3YRSCONS  FAMINC30STATUS4YRSCONS 	FAMINC30DURATION4YRSCONS  FAMINC30STATUS5YRSCONS 	FAMINC30DURATION5YRSCONS  FAMINC30STATUS10YRSCONS	FAMINC30DURATION10YRSCONS	FAMINC30STATUS2YRSNONCONS	FAMINC30DURATION2YRSNONCONS 	FAMINC30STATUS3YRSNONCONS	FAMINC30DURATION3YRSNONCONS	FAMINC30STATUS4YRSNONCONS	FAMINC30DURATION4YRSNONCONS	FAMINC30STATUS5YRSNONCONS	FAMINC30DURATION5YRSNONCONS FAMINC30STATUS10YRSNONCONS	FAMINC30DURATION10YRSNONCONS
FAMINC40DURATION1STEXPER		FAMINC40STATUS	FAMINC40STATUS2YRSCONS 	FAMINC40DURATION2YRSCONS  FAMINC40STATUS3YRSCONS 	FAMINC40DURATION3YRSCONS  FAMINC40STATUS4YRSCONS 	FAMINC40DURATION4YRSCONS  FAMINC40STATUS5YRSCONS 	FAMINC40DURATION5YRSCONS  FAMINC40STATUS10YRSCONS	FAMINC40DURATION10YRSCONS	FAMINC40STATUS2YRSNONCONS	FAMINC40DURATION2YRSNONCONS 	FAMINC40STATUS3YRSNONCONS	FAMINC40DURATION3YRSNONCONS	FAMINC40STATUS4YRSNONCONS	FAMINC40DURATION4YRSNONCONS	FAMINC40STATUS5YRSNONCONS	FAMINC40DURATION5YRSNONCONS FAMINC40STATUS10YRSNONCONS	FAMINC40DURATION10YRSNONCONS
FAMINC50DURATION1STEXPER		FAMINC50STATUS	FAMINC50STATUS2YRSCONS 	FAMINC50DURATION2YRSCONS  FAMINC50STATUS3YRSCONS 	FAMINC50DURATION3YRSCONS  FAMINC50STATUS4YRSCONS 	FAMINC50DURATION4YRSCONS  FAMINC50STATUS5YRSCONS 	FAMINC50DURATION5YRSCONS  FAMINC50STATUS10YRSCONS	FAMINC50DURATION10YRSCONS	FAMINC50STATUS2YRSNONCONS	FAMINC50DURATION2YRSNONCONS 	FAMINC50STATUS3YRSNONCONS	FAMINC50DURATION3YRSNONCONS	FAMINC50STATUS4YRSNONCONS	FAMINC50DURATION4YRSNONCONS	FAMINC50STATUS5YRSNONCONS	FAMINC50DURATION5YRSNONCONS FAMINC50STATUS10YRSNONCONS	FAMINC50DURATION10YRSNONCONS
P15WELFY50DURATION1STEXPER		P15WELFY50STATUS	P15WELFY50STATUS2YRSCONS 	P15WELFY50DURATION2YRSCONS  P15WELFY50STATUS3YRSCONS 	P15WELFY50DURATION3YRSCONS  P15WELFY50STATUS4YRSCONS 	P15WELFY50DURATION4YRSCONS  P15WELFY50STATUS5YRSCONS 	P15WELFY50DURATION5YRSCONS  P15WELFY50STATUS10YRSCONS	P15WELFY50DURATION10YRSCONS	P15WELFY50STATUS2YRSNONCONS	P15WELFY50DURATION2YRSNONCONS 	P15WELFY50STATUS3YRSNONCONS	P15WELFY50DURATION3YRSNONCONS	P15WELFY50STATUS4YRSNONCONS	P15WELFY50DURATION4YRSNONCONS	P15WELFY50STATUS5YRSNONCONS	P15WELFY50DURATION5YRSNONCONS P15WELFY50STATUS10YRSNONCONS	P15WELFY50DURATION10YRSNONCONS
UNEMPLOYMENTDURATION1STEXPER	UNEMPLOYMENTSTATUS	UNEMPLOYMENTSTATUS2YRSCONS 	UNEMPLOYMENTDURATION2YRSCONS  UNEMPLOYMENTSTATUS3YRSCONS 	UNEMPLOYMENTDURATION3YRSCONS  UNEMPLOYMENTSTATUS4YRSCONS 	UNEMPLOYMENTDURATION4YRSCONS  UNEMPLOYMENTSTATUS5YRSCONS 	UNEMPLOYMENTDURATION5YRSCONS  UNEMPLOYMENTSTATUS10YRSCONS	UNEMPLOYMENTDURATION10YRSCONS	UNEMPLOYMENTSTATUS2YRSNONCONS	UNEMPLOYMENTDURATION2YRSNONCONS 	UNEMPLOYMENTSTATUS3YRSNONCONS	UNEMPLOYMENTDURATION3YRSNONCONS	UNEMPLOYMENTSTATUS4YRSNONCONS	UNEMPLOYMENTDURATION4YRSNONCONS	UNEMPLOYMENTSTATUS5YRSNONCONS	UNEMPLOYMENTDURATION5YRSNONCONS UNEMPLOYMENTSTATUS10YRSNONCONS	UNEMPLOYMENTDURATION10YRSNONCONS
P15WY50UNEDURATION1STEXPER		P15WY50UNESTATUS	P15WY50UNESTATUS2YRSCONS 	P15WY50UNEDURATION2YRSCONS  P15WY50UNESTATUS3YRSCONS 	P15WY50UNEDURATION3YRSCONS  P15WY50UNESTATUS4YRSCONS 	P15WY50UNEDURATION4YRSCONS  P15WY50UNESTATUS5YRSCONS 	P15WY50UNEDURATION5YRSCONS  P15WY50UNESTATUS10YRSCONS	P15WY50UNEDURATION10YRSCONS	P15WY50UNESTATUS2YRSNONCONS	P15WY50UNEDURATION2YRSNONCONS 	P15WY50UNESTATUS3YRSNONCONS	P15WY50UNEDURATION3YRSNONCONS	P15WY50UNESTATUS4YRSNONCONS	P15WY50UNEDURATION4YRSNONCONS	P15WY50UNESTATUS5YRSNONCONS	P15WY50UNEDURATION5YRSNONCONS P15WY50UNESTATUS10YRSNONCONS	P15WY50UNEDURATION10YRSNONCONS
FAMINC100KDURATION1STEXPER		FAMINC100KSTATUS	FAMINC100KSTATUS2YRSCONS 	FAMINC100KDURATION2YRSCONS  FAMINC100KSTATUS3YRSCONS 	FAMINC100KDURATION3YRSCONS  FAMINC100KSTATUS4YRSCONS 	FAMINC100KDURATION4YRSCONS  FAMINC100KSTATUS5YRSCONS 	FAMINC100KDURATION5YRSCONS  FAMINC100KSTATUS10YRSCONS	FAMINC100KDURATION10YRSCONS	FAMINC100KSTATUS2YRSNONCONS	FAMINC100KDURATION2YRSNONCONS 	FAMINC100KSTATUS3YRSNONCONS	FAMINC100KDURATION3YRSNONCONS	FAMINC100KSTATUS4YRSNONCONS	FAMINC100KDURATION4YRSNONCONS	FAMINC100KSTATUS5YRSNONCONS	FAMINC100KDURATION5YRSNONCONS FAMINC100KSTATUS10YRSNONCONS	FAMINC100KDURATION10YRSNONCONS
FAMINC150KDURATION1STEXPER		FAMINC150KSTATUS	FAMINC150KSTATUS2YRSCONS 	FAMINC150KDURATION2YRSCONS  FAMINC150KSTATUS3YRSCONS 	FAMINC150KDURATION3YRSCONS  FAMINC150KSTATUS4YRSCONS 	FAMINC150KDURATION4YRSCONS  FAMINC150KSTATUS5YRSCONS 	FAMINC150KDURATION5YRSCONS  FAMINC150KSTATUS10YRSCONS	FAMINC150KDURATION10YRSCONS	FAMINC150KSTATUS2YRSNONCONS	FAMINC150KDURATION2YRSNONCONS 	FAMINC150KSTATUS3YRSNONCONS	FAMINC150KDURATION3YRSNONCONS	FAMINC150KSTATUS4YRSNONCONS	FAMINC150KDURATION4YRSNONCONS	FAMINC150KSTATUS5YRSNONCONS	FAMINC150KDURATION5YRSNONCONS FAMINC150KSTATUS10YRSNONCONS	FAMINC150KDURATION10YRSNONCONS
FAMINC200KDURATION1STEXPER		FAMINC200KSTATUS	FAMINC200KSTATUS2YRSCONS 	FAMINC200KDURATION2YRSCONS  FAMINC200KSTATUS3YRSCONS 	FAMINC200KDURATION3YRSCONS  FAMINC200KSTATUS4YRSCONS 	FAMINC200KDURATION4YRSCONS  FAMINC200KSTATUS5YRSCONS 	FAMINC200KDURATION5YRSCONS  FAMINC200KSTATUS10YRSCONS	FAMINC200KDURATION10YRSCONS	FAMINC200KSTATUS2YRSNONCONS	FAMINC200KDURATION2YRSNONCONS 	FAMINC200KSTATUS3YRSNONCONS	FAMINC200KDURATION3YRSNONCONS	FAMINC200KSTATUS4YRSNONCONS	FAMINC200KDURATION4YRSNONCONS	FAMINC200KSTATUS5YRSNONCONS	FAMINC200KDURATION5YRSNONCONS FAMINC200KSTATUS10YRSNONCONS	FAMINC200KDURATION10YRSNONCONS
FAMINC250KDURATION1STEXPER		FAMINC250KSTATUS	FAMINC250KSTATUS2YRSCONS 	FAMINC250KDURATION2YRSCONS  FAMINC250KSTATUS3YRSCONS 	FAMINC250KDURATION3YRSCONS  FAMINC250KSTATUS4YRSCONS 	FAMINC250KDURATION4YRSCONS  FAMINC250KSTATUS5YRSCONS 	FAMINC250KDURATION5YRSCONS  FAMINC250KSTATUS10YRSCONS	FAMINC250KDURATION10YRSCONS	FAMINC250KSTATUS2YRSNONCONS	FAMINC250KDURATION2YRSNONCONS 	FAMINC250KSTATUS3YRSNONCONS	FAMINC250KDURATION3YRSNONCONS	FAMINC250KSTATUS4YRSNONCONS	FAMINC250KDURATION4YRSNONCONS	FAMINC250KSTATUS5YRSNONCONS	FAMINC250KDURATION5YRSNONCONS FAMINC250KSTATUS10YRSNONCONS	FAMINC250KDURATION10YRSNONCONS
FOODSTAMPSDURATION1STEXPER		FOODSTAMPSSTATUS	FOODSTAMPSSTATUS2YRSCONS 	FOODSTAMPSDURATION2YRSCONS  FOODSTAMPSSTATUS3YRSCONS 	FOODSTAMPSDURATION3YRSCONS  FOODSTAMPSSTATUS4YRSCONS 	FOODSTAMPSDURATION4YRSCONS  FOODSTAMPSSTATUS5YRSCONS 	FOODSTAMPSDURATION5YRSCONS  FOODSTAMPSSTATUS10YRSCONS	FOODSTAMPSDURATION10YRSCONS	FOODSTAMPSSTATUS2YRSNONCONS	FOODSTAMPSDURATION2YRSNONCONS 	FOODSTAMPSSTATUS3YRSNONCONS	FOODSTAMPSDURATION3YRSNONCONS	FOODSTAMPSSTATUS4YRSNONCONS	FOODSTAMPSDURATION4YRSNONCONS	FOODSTAMPSSTATUS5YRSNONCONS	FOODSTAMPSDURATION5YRSNONCONS FOODSTAMPSSTATUS10YRSNONCONS	FOODSTAMPSDURATION10YRSNONCONS
GAIN30DURATION1STEXPER		GAIN30STATUS	GAIN30STATUS2YRSCONS 	GAIN30DURATION2YRSCONS  GAIN30STATUS3YRSCONS 	GAIN30DURATION3YRSCONS  GAIN30STATUS4YRSCONS 	GAIN30DURATION4YRSCONS  GAIN30STATUS5YRSCONS 	GAIN30DURATION5YRSCONS  GAIN30STATUS10YRSCONS	GAIN30DURATION10YRSCONS	GAIN30STATUS2YRSNONCONS	GAIN30DURATION2YRSNONCONS 	GAIN30STATUS3YRSNONCONS	GAIN30DURATION3YRSNONCONS	GAIN30STATUS4YRSNONCONS	GAIN30DURATION4YRSNONCONS	GAIN30STATUS5YRSNONCONS	GAIN30DURATION5YRSNONCONS GAIN30STATUS10YRSNONCONS	GAIN30DURATION10YRSNONCONS
GAIN40DURATION1STEXPER		GAIN40STATUS	GAIN40STATUS2YRSCONS 	GAIN40DURATION2YRSCONS  GAIN40STATUS3YRSCONS 	GAIN40DURATION3YRSCONS  GAIN40STATUS4YRSCONS 	GAIN40DURATION4YRSCONS  GAIN40STATUS5YRSCONS 	GAIN40DURATION5YRSCONS  GAIN40STATUS10YRSCONS	GAIN40DURATION10YRSCONS	GAIN40STATUS2YRSNONCONS	GAIN40DURATION2YRSNONCONS 	GAIN40STATUS3YRSNONCONS	GAIN40DURATION3YRSNONCONS	GAIN40STATUS4YRSNONCONS	GAIN40DURATION4YRSNONCONS	GAIN40STATUS5YRSNONCONS	GAIN40DURATION5YRSNONCONS GAIN40STATUS10YRSNONCONS	GAIN40DURATION10YRSNONCONS
GAIN50DURATION1STEXPER		GAIN50STATUS	GAIN50STATUS2YRSCONS 	GAIN50DURATION2YRSCONS  GAIN50STATUS3YRSCONS 	GAIN50DURATION3YRSCONS  GAIN50STATUS4YRSCONS 	GAIN50DURATION4YRSCONS  GAIN50STATUS5YRSCONS 	GAIN50DURATION5YRSCONS  GAIN50STATUS10YRSCONS	GAIN50DURATION10YRSCONS	GAIN50STATUS2YRSNONCONS	GAIN50DURATION2YRSNONCONS 	GAIN50STATUS3YRSNONCONS	GAIN50DURATION3YRSNONCONS	GAIN50STATUS4YRSNONCONS	GAIN50DURATION4YRSNONCONS	GAIN50STATUS5YRSNONCONS	GAIN50DURATION5YRSNONCONS GAIN50STATUS10YRSNONCONS	GAIN50DURATION10YRSNONCONS
HOMEOWNERDURATION1STEXPER		HOMEOWNERSTATUS	HOMEOWNERSTATUS2YRSCONS 	HOMEOWNERDURATION2YRSCONS  HOMEOWNERSTATUS3YRSCONS 	HOMEOWNERDURATION3YRSCONS  HOMEOWNERSTATUS4YRSCONS 	HOMEOWNERDURATION4YRSCONS  HOMEOWNERSTATUS5YRSCONS 	HOMEOWNERDURATION5YRSCONS  HOMEOWNERSTATUS10YRSCONS	HOMEOWNERDURATION10YRSCONS	HOMEOWNERSTATUS2YRSNONCONS	HOMEOWNERDURATION2YRSNONCONS 	HOMEOWNERSTATUS3YRSNONCONS	HOMEOWNERDURATION3YRSNONCONS	HOMEOWNERSTATUS4YRSNONCONS	HOMEOWNERDURATION4YRSNONCONS	HOMEOWNERSTATUS5YRSNONCONS	HOMEOWNERDURATION5YRSNONCONS HOMEOWNERSTATUS10YRSNONCONS	HOMEOWNERDURATION10YRSNONCONS
HE25KDURATION1STEXPER		HE25KSTATUS		HE25KSTATUS2YRSCONS 	HE25KDURATION2YRSCONS  	HE25KSTATUS3YRSCONS 	HE25KDURATION3YRSCONS  	HE25KSTATUS4YRSCONS 	HE25KDURATION4YRSCONS  HE25KSTATUS5YRSCONS 	HE25KDURATION5YRSCONS  HE25KSTATUS10YRSCONS	HE25KDURATION10YRSCONS	HE25KSTATUS2YRSNONCONS	HE25KDURATION2YRSNONCONS 	HE25KSTATUS3YRSNONCONS	HE25KDURATION3YRSNONCONS	HE25KSTATUS4YRSNONCONS	HE25KDURATION4YRSNONCONS	HE25KSTATUS5YRSNONCONS	HE25KDURATION5YRSNONCONS HE25KSTATUS10YRSNONCONS	HE25KDURATION10YRSNONCONS
HE50KDURATION1STEXPER		HE50KSTATUS		HE50KSTATUS2YRSCONS 	HE50KDURATION2YRSCONS  HE50KSTATUS3YRSCONS 	HE50KDURATION3YRSCONS  HE50KSTATUS4YRSCONS 	HE50KDURATION4YRSCONS  HE50KSTATUS5YRSCONS 	HE50KDURATION5YRSCONS  HE50KSTATUS10YRSCONS	HE50KDURATION10YRSCONS	HE50KSTATUS2YRSNONCONS	HE50KDURATION2YRSNONCONS 	HE50KSTATUS3YRSNONCONS	HE50KDURATION3YRSNONCONS	HE50KSTATUS4YRSNONCONS	HE50KDURATION4YRSNONCONS	HE50KSTATUS5YRSNONCONS	HE50KDURATION5YRSNONCONS HE50KSTATUS10YRSNONCONS	HE50KDURATION10YRSNONCONS
HE100KDURATION1STEXPER		HE100KSTATUS	HE100KSTATUS2YRSCONS 	HE100KDURATION2YRSCONS  HE100KSTATUS3YRSCONS 	HE100KDURATION3YRSCONS  HE100KSTATUS4YRSCONS 	HE100KDURATION4YRSCONS  HE100KSTATUS5YRSCONS 	HE100KDURATION5YRSCONS  HE100KSTATUS10YRSCONS	HE100KDURATION10YRSCONS	HE100KSTATUS2YRSNONCONS	HE100KDURATION2YRSNONCONS 	HE100KSTATUS3YRSNONCONS	HE100KDURATION3YRSNONCONS	HE100KSTATUS4YRSNONCONS	HE100KDURATION4YRSNONCONS	HE100KSTATUS5YRSNONCONS	HE100KDURATION5YRSNONCONS HE100KSTATUS10YRSNONCONS	HE100KDURATION10YRSNONCONS
HE200KDURATION1STEXPER		HE200KSTATUS	HE200KSTATUS2YRSCONS 	HE200KDURATION2YRSCONS  HE200KSTATUS3YRSCONS 	HE200KDURATION3YRSCONS  HE200KSTATUS4YRSCONS 	HE200KDURATION4YRSCONS  HE200KSTATUS5YRSCONS 	HE200KDURATION5YRSCONS  HE200KSTATUS10YRSCONS	HE200KDURATION10YRSCONS	HE200KSTATUS2YRSNONCONS	HE200KDURATION2YRSNONCONS 	HE200KSTATUS3YRSNONCONS	HE200KDURATION3YRSNONCONS	HE200KSTATUS4YRSNONCONS	HE200KDURATION4YRSNONCONS	HE200KSTATUS5YRSNONCONS	HE200KDURATION5YRSNONCONS HE200KSTATUS10YRSNONCONS	HE200KDURATION10YRSNONCONS
FAMINCAT81PDURATION1STEXPER		FAMINCAT81PSTATUS	FAMINCAT81PSTATUS2YRSCONS 	FAMINCAT81PDURATION2YRSCONS  FAMINCAT81PSTATUS3YRSCONS 	FAMINCAT81PDURATION3YRSCONS  FAMINCAT81PSTATUS4YRSCONS 	FAMINCAT81PDURATION4YRSCONS  FAMINCAT81PSTATUS5YRSCONS 	FAMINCAT81PDURATION5YRSCONS  FAMINCAT81PSTATUS10YRSCONS	FAMINCAT81PDURATION10YRSCONS	FAMINCAT81PSTATUS2YRSNONCONS	FAMINCAT81PDURATION2YRSNONCONS 	FAMINCAT81PSTATUS3YRSNONCONS	FAMINCAT81PDURATION3YRSNONCONS	FAMINCAT81PSTATUS4YRSNONCONS	FAMINCAT81PDURATION4YRSNONCONS	FAMINCAT81PSTATUS5YRSNONCONS	FAMINCAT81PDURATION5YRSNONCONS FAMINCAT81PSTATUS10YRSNONCONS	FAMINCAT81PDURATION10YRSNONCONS
FAMINCAT91PDURATION1STEXPER		FAMINCAT91PSTATUS	FAMINCAT91PSTATUS2YRSCONS 	FAMINCAT91PDURATION2YRSCONS  FAMINCAT91PSTATUS3YRSCONS 	FAMINCAT91PDURATION3YRSCONS  FAMINCAT91PSTATUS4YRSCONS 	FAMINCAT91PDURATION4YRSCONS  FAMINCAT91PSTATUS5YRSCONS 	FAMINCAT91PDURATION5YRSCONS  FAMINCAT91PSTATUS10YRSCONS	FAMINCAT91PDURATION10YRSCONS	FAMINCAT91PSTATUS2YRSNONCONS	FAMINCAT91PDURATION2YRSNONCONS 	FAMINCAT91PSTATUS3YRSNONCONS	FAMINCAT91PDURATION3YRSNONCONS	FAMINCAT91PSTATUS4YRSNONCONS	FAMINCAT91PDURATION4YRSNONCONS	FAMINCAT91PSTATUS5YRSNONCONS	FAMINCAT91PDURATION5YRSNONCONS FAMINCAT91PSTATUS10YRSNONCONS	FAMINCAT91PDURATION10YRSNONCONS
FAMINCAT96PDURATION1STEXPER		FAMINCAT96PSTATUS	FAMINCAT96PSTATUS2YRSCONS 	FAMINCAT96PDURATION2YRSCONS  FAMINCAT96PSTATUS3YRSCONS 	FAMINCAT96PDURATION3YRSCONS  FAMINCAT96PSTATUS4YRSCONS 	FAMINCAT96PDURATION4YRSCONS  FAMINCAT96PSTATUS5YRSCONS 	FAMINCAT96PDURATION5YRSCONS  FAMINCAT96PSTATUS10YRSCONS	FAMINCAT96PDURATION10YRSCONS	FAMINCAT96PSTATUS2YRSNONCONS	FAMINCAT96PDURATION2YRSNONCONS 	FAMINCAT96PSTATUS3YRSNONCONS	FAMINCAT96PDURATION3YRSNONCONS	FAMINCAT96PSTATUS4YRSNONCONS	FAMINCAT96PDURATION4YRSNONCONS	FAMINCAT96PSTATUS5YRSNONCONS	FAMINCAT96PDURATION5YRSNONCONS FAMINCAT96PSTATUS10YRSNONCONS	FAMINCAT96PDURATION10YRSNONCONS
FAMINCAT100PDURATION1STEXPER	FAMINCAT100PSTATUS	FAMINCAT100PSTATUS2YRSCONS 	FAMINCAT100PDURATION2YRSCONS  FAMINCAT100PSTATUS3YRSCONS 	FAMINCAT100PDURATION3YRSCONS  FAMINCAT100PSTATUS4YRSCONS 	FAMINCAT100PDURATION4YRSCONS  FAMINCAT100PSTATUS5YRSCONS 	FAMINCAT100PDURATION5YRSCONS  FAMINCAT100PSTATUS10YRSCONS	FAMINCAT100PDURATION10YRSCONS	FAMINCAT100PSTATUS2YRSNONCONS	FAMINCAT100PDURATION2YRSNONCONS 	FAMINCAT100PSTATUS3YRSNONCONS	FAMINCAT100PDURATION3YRSNONCONS	FAMINCAT100PSTATUS4YRSNONCONS	FAMINCAT100PDURATION4YRSNONCONS	FAMINCAT100PSTATUS5YRSNONCONS	FAMINCAT100PDURATION5YRSNONCONS FAMINCAT100PSTATUS10YRSNONCONS	FAMINCAT100PDURATION10YRSNONCONS
SAEZ90PDURATION1STEXPER		SAEZ90PSTATUS		SAEZ90PSTATUS2YRSCONS 	SAEZ90PDURATION2YRSCONS  	SAEZ90PSTATUS3YRSCONS 	SAEZ90PDURATION3YRSCONS  	SAEZ90PSTATUS4YRSCONS 	SAEZ90PDURATION4YRSCONS  SAEZ90PSTATUS5YRSCONS 	SAEZ90PDURATION5YRSCONS  SAEZ90PSTATUS10YRSCONS	SAEZ90PDURATION10YRSCONS	SAEZ90PSTATUS2YRSNONCONS	SAEZ90PDURATION2YRSNONCONS 	SAEZ90PSTATUS3YRSNONCONS	SAEZ90PDURATION3YRSNONCONS	SAEZ90PSTATUS4YRSNONCONS	SAEZ90PDURATION4YRSNONCONS	SAEZ90PSTATUS5YRSNONCONS	SAEZ90PDURATION5YRSNONCONS SAEZ90PSTATUS10YRSNONCONS	SAEZ90PDURATION10YRSNONCONS
SAEZ95PDURATION1STEXPER		SAEZ95PSTATUS		SAEZ95PSTATUS2YRSCONS 	SAEZ95PDURATION2YRSCONS  SAEZ95PSTATUS3YRSCONS 	SAEZ95PDURATION3YRSCONS  SAEZ95PSTATUS4YRSCONS 	SAEZ95PDURATION4YRSCONS  SAEZ95PSTATUS5YRSCONS 	SAEZ95PDURATION5YRSCONS  SAEZ95PSTATUS10YRSCONS	SAEZ95PDURATION10YRSCONS	SAEZ95PSTATUS2YRSNONCONS	SAEZ95PDURATION2YRSNONCONS 	SAEZ95PSTATUS3YRSNONCONS	SAEZ95PDURATION3YRSNONCONS	SAEZ95PSTATUS4YRSNONCONS	SAEZ95PDURATION4YRSNONCONS	SAEZ95PSTATUS5YRSNONCONS	SAEZ95PDURATION5YRSNONCONS SAEZ95PSTATUS10YRSNONCONS	SAEZ95PDURATION10YRSNONCONS
SAEZ99PDURATION1STEXPER		SAEZ99PSTATUS		SAEZ99PSTATUS2YRSCONS 	SAEZ99PDURATION2YRSCONS  SAEZ99PSTATUS3YRSCONS 	SAEZ99PDURATION3YRSCONS  SAEZ99PSTATUS4YRSCONS 	SAEZ99PDURATION4YRSCONS  SAEZ99PSTATUS5YRSCONS 	SAEZ99PDURATION5YRSCONS  SAEZ99PSTATUS10YRSCONS	SAEZ99PDURATION10YRSCONS	SAEZ99PSTATUS2YRSNONCONS	SAEZ99PDURATION2YRSNONCONS 	SAEZ99PSTATUS3YRSNONCONS	SAEZ99PDURATION3YRSNONCONS	SAEZ99PSTATUS4YRSNONCONS	SAEZ99PDURATION4YRSNONCONS	SAEZ99PSTATUS5YRSNONCONS	SAEZ99PDURATION5YRSNONCONS SAEZ99PSTATUS10YRSNONCONS	SAEZ99PDURATION10YRSNONCONS
);
MERGE
PSIDLT&SY..DURATION_POVERTY05_&SY
PSIDLT&SY..DURATION_POVERTY10_&SY
PSIDLT&SY..DURATION_POVERTY125_&SY
PSIDLT&SY..DURATION_POVERTY15_&SY
PSIDLT&SY..DURATION_AFFLUENCE08_&SY
PSIDLT&SY..DURATION_AFFLUENCE09_&SY
PSIDLT&SY..DURATION_AFFLUENCE10_&SY
PSIDLT&SY..DURATION_AFFLUENCE11_&SY
PSIDLT&SY..DURATION_AFFLUENCE12_&SY
PSIDLT&SY..DURATION_WELFARE_&SY
PSIDLT&SY..DURATION_FAMINC30_&SY
PSIDLT&SY..DURATION_FAMINC40_&SY
PSIDLT&SY..DURATION_FAMINC50_&SY
PSIDLT&SY..DURATION_P15WELFY50_&SY
PSIDLT&SY..DURATION_UNEMPLOYMENT_&SY
PSIDLT&SY..DURATION_P15WY50UNE_&SY
PSIDLT&SY..DURATION_FAMINC100K_&SY
PSIDLT&SY..DURATION_FAMINC150K_&SY
PSIDLT&SY..DURATION_FAMINC200K_&SY
PSIDLT&SY..DURATION_FAMINC250K_&SY
PSIDLT&SY..DURATION_FOODSTAMPS_&SY
PSIDLT&SY..DURATION_GAIN30_&SY
PSIDLT&SY..DURATION_GAIN40_&SY
PSIDLT&SY..DURATION_GAIN50_&SY
PSIDLT&SY..DURATION_HOMEOWNER_&SY
PSIDLT&SY..DURATION_HE25K_&SY
PSIDLT&SY..DURATION_HE50K_&SY
PSIDLT&SY..DURATION_HE100K_&SY
PSIDLT&SY..DURATION_HE200K_&SY
PSIDLT&SY..DURATION_FAMINCAT81P_&SY
PSIDLT&SY..DURATION_FAMINCAT91P_&SY
PSIDLT&SY..DURATION_FAMINCAT96P_&SY
PSIDLT&SY..DURATION_FAMINCAT100P_&SY
PSIDLT&SY..DURATION_SAEZ90P_&SY
PSIDLT&SY..DURATION_SAEZ95P_&SY
PSIDLT&SY..DURATION_SAEZ99P_&SY
;
BY ER30001 ER30002;
RUN;


PROC SORT DATA = PSIDLT&SY..DURATIONDATA;
BY ER30001 ER30002 ;
RUN;

PROC SORT DATA = PSIDLT&SY..COVARIATESAT&SY;
BY ER30001 ER30002 ;
RUN;

DATA PSIDLT&SY..COV_DUR_ALLTHEMES_&SY._%sysfunc(today(), mmddyy6.);
MERGE PSIDLT&SY..COVARIATESAT&SY PSIDLT&SY..DURATIONDATA;
BY ER30001 ER30002 ;
*REMOVE LATINOS;
IF ER30001 < 7000;
RUN;


PROC EXPORT DATA= PSIDLT&SY..COV_DUR_ALLTHEMES_&SY._%sysfunc(today(), mmddyy6.) 
            OUTFILE= "U:\1Projects\PSID\WAVE37\LIFETABLES&SY\COV_DUR_ALLTHEMES_&SY._%sysfunc(today(), mmddyy6.).SAV" 
            DBMS=SPSS REPLACE;
RUN;

ODS PDF FILE = "U:\1Projects\PSID\WAVE37\LIFETABLES&SY\COV_DUR_ALLTHEMES_&SY._%sysfunc(today(), mmddyy6.)_CODEBOOK.PDF";
PROC CONTENTS DATA = PSIDLT&SY..COV_DUR_ALLTHEMES_&SY._%sysfunc(today(), mmddyy6.) VARNUM;
RUN;
ODS PDF CLOSE;


*/

